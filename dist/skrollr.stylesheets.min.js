/*! skrollr-stylesheets 0.0.4 (2014-03-28) | Alexander Prinzhorn - https://github.com/Prinzhorn/skrollr-stylesheets | Free to use under terms of MIT license */
define(function(){"use strict";function a(){for(var a,b=document.body.querySelectorAll("*"),c=[],d=0,e=b.length;e>d;d++){a=b[d];for(var f=0;f<a.attributes.length;f++){var g=a.attributes[f];/data-[0-9]+/.test(g.name)&&c.push(g.name)}for(f=0;f<c.length;f++)a.removeAttribute(c[f])}}function b(){n(!0)}var c,d,e,f=[],g=30,h=/@-skrollr-keyframes\s+([\w-]+)/g,i=/\s*\{\s*((?:[^{]+\{[^}]*\}\s*)+?)\s*\}/g,j=/([\w\-]+)\s*\{([^}]+)\}/g,k=/-skrollr-animation-name\s*:\s*([\w-]+)/g,l=function(a){var b=new XMLHttpRequest;try{b.open("GET",a,!1),b.send(null)}catch(c){window.XDomainRequest&&(b=new XDomainRequest,b.open("GET",a,!1),b.send(null))}return b.responseText},m=function(a,b){e=b;for(var c=0;c<a.length;c++){var d,g=a[c];if("LINK"===g.tagName){if(null===g.getAttribute("data-skrollr-stylesheet"))continue;d=l(g.href)}else d=g.textContent||g.innerText||g.innerHTML;d&&f.push({content:d,media:g.getAttribute("media"),animations:{},selectors:[]})}f.reverse();for(var h=0;h<f.length;h++)d=f[h].content,o(d,f[h].animations),p(d,f[h].selectors);n(!1)},n=function(b){var h,i,j,k,l=(new Date).getTime();if(b&&c&&g>l-c)return window.clearTimeout(d),void(d=window.setTimeout(n,g));c=l,h={},i=[];for(var m=0,o=f.length;o>m;m++)if(j=f[m],k=j.media,!matchMedia||!k||matchMedia(k).matches){i=i.concat(j.selectors);for(var p in j.animations)j.animations.hasOwnProperty(p)&&(h[p]=j.animations[p])}a(),q(h,i),e.refresh()},o=function(a,b){h.lastIndex=0;for(var c,d,e,f;null!==(c=h.exec(a));)for(i.lastIndex=h.lastIndex,d=i.exec(a),j.lastIndex=0,f=b[c[1]]={};null!==(e=j.exec(d[1]));)f[e[1]]=e[2].replace(/[\n\r\t]/g,"")},p=function(a,b){k.lastIndex=0;for(var c,d,e;null!==(c=k.exec(a));){for(e=k.lastIndex;e--&&"{"!==a.charAt(e););for(d=e;d--&&"}"!==a.charAt(d-1););b.push([a.substring(d,e).replace(/[\n\r\t]/g,""),c[1]])}},q=function(a,b){for(var c,d,e,f,g,h,i,j=0;j<b.length;j++)if(c=document.querySelectorAll(b[j][0])){d=a[b[j][1]];for(e in d)for(f=0;f<c.length;f++)i=c[f],g="data-"+e,h=d[e],i.hasAttribute(g)&&(h+=i.getAttribute(g)),i.setAttribute(g,h)}};return{init:function(a){m(document.querySelectorAll("link, style"),a),window.addEventListener?window.addEventListener("resize",b,!1):window.attachEvent&&window.attachEvent("onresize",b)}}});